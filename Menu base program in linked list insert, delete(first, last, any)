#include <stdio.h>
#include <stdlib.h>

// Create Node Structure
struct Node {
    int data;
    struct Node *next;
};

// Global head pointer
struct Node *head = NULL;

// Function Prototypes
void insertFirst();
void insertLast();
void insertAtPosition();
void deleteFirst();
void deleteLast();
void deleteAtPosition();
void display();

int main() {
    int choice;

    while (1) {
        printf("\n\n---- LINKED LIST MENU ----");
        printf("\n1. Insert at First");
        printf("\n2. Insert at Last");
        printf("\n3. Insert at Any Position");
        printf("\n4. Delete from First");
        printf("\n5. Delete from Last");
        printf("\n6. Delete from Any Position");
        printf("\n7. Display");
        printf("\n8. Exit");
        printf("\nEnter your choice: ");
        scanf("%d", &choice);

        switch (choice) {
            case 1: insertFirst(); break;
            case 2: insertLast(); break;
            case 3: insertAtPosition(); break;
            case 4: deleteFirst(); break;
            case 5: deleteLast(); break;
            case 6: deleteAtPosition(); break;
            case 7: display(); break;
            case 8: exit(0);
            default: printf("Invalid Choice!");
        }
    }
    return 0;
}

// Insert at Beginning
void insertFirst() {
    struct Node *newNode;
    newNode = (struct Node *)malloc(sizeof(struct Node));

    printf("Enter value: ");
    scanf("%d", &newNode->data);

    newNode->next = head;
    head = newNode;

    printf("Inserted at First Successfully!");
}

// Insert at End
void insertLast() {
    struct Node *newNode, *temp;
    newNode = (struct Node *)malloc(sizeof(struct Node));

    printf("Enter value: ");
    scanf("%d", &newNode->data);
    newNode->next = NULL;

    if (head == NULL) {
        head = newNode;
    } else {
        temp = head;
        while (temp->next != NULL)
            temp = temp->next;

        temp->next = newNode;
    }
    printf("Inserted at Last Successfully!");
}

// Insert at Any Position
void insertAtPosition() {
    struct Node *newNode, *temp;
    int pos, i;

    printf("Enter position: ");
    scanf("%d", &pos);

    if (pos == 1) {
        insertFirst();
        return;
    }

    newNode = (struct Node *)malloc(sizeof(struct Node));

    printf("Enter value: ");
    scanf("%d", &newNode->data);

    temp = head;

    for (i = 1; i < pos - 1; i++) {
        if (temp == NULL) {
            printf("Invalid Position!");
            return;
        }
        temp = temp->next;
    }

    newNode->next = temp->next;
    temp->next = newNode;

    printf("Inserted at Position %d Successfully!", pos);
}

// Delete from Beginning
void deleteFirst() {
    struct Node *temp;

    if (head == NULL) {
        printf("List is Empty!");
        return;
    }

    temp = head;
    head = head->next;
    free(temp);

    printf("Deleted First Node Successfully!");
}

// Delete from End
void deleteLast() {
    struct Node *temp, *prev;

    if (head == NULL) {
        printf("List is Empty!");
        return;
    }

    if (head->next == NULL) {
        free(head);
        head = NULL;
        printf("Last Node Deleted!");
        return;
    }

    temp = head;
    while (temp->next != NULL) {
        prev = temp;
        temp = temp->next;
    }

    prev->next = NULL;
    free(temp);

    printf("Deleted Last Node Successfully!");
}

// Delete at Any Position
void deleteAtPosition() {
    struct Node *temp, *nextNode;
    int pos, i;

    printf("Enter position to delete: ");
    scanf("%d", &pos);

    if (pos == 1) {
        deleteFirst();
        return;
    }

    temp = head;

    for (i = 1; i < pos - 1; i++) {
        if (temp == NULL || temp->next == NULL) {
            printf("Invalid Position!");
            return;
        }
        temp = temp->next;
    }

    nextNode = temp->next;
    temp->next = nextNode->next;
    free(nextNode);

    printf("Deleted Node at Position %d Successfully!", pos);
}

// Display Linked List
void display() {
    struct Node *temp;

    if (head == NULL) {
        printf("List is Empty!");
        return;
    }

    temp = head;
    printf("Linked List: ");

    while (temp != NULL) {
        printf("%d -> ", temp->data);
        temp = temp->next;
    }

    printf("NULL");
}
